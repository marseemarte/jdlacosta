<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Formulario Vínculo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .form-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        .form-section {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background: #fafafa;
        }
        .form-section h5 {
            color: #0047AB;
            margin-bottom: 15px;
            border-bottom: 2px solid #0047AB;
            padding-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="form-container">
        <h2 class="mb-4" style="color: #0047AB;">Test Formulario de Vínculos</h2>
        
        <form id="testForm">
            <!-- Sección de Vínculo -->
            <div class="form-section">
                <h5><i class="fas fa-link"></i> Vínculo con la escuela</h5>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label for="vinculo" class="form-label">Vínculo con la escuela</label>
                        <select class="form-select" id="vinculo" name="vinculo" required>
                            <option value="">Seleccione un vínculo</option>
                            <option value="1">Ninguno</option>
                            <option value="2">Hermano/a de alumno/a</option>
                            <option value="3">Hijo/a de profesor/a</option>
                            <option value="4">PPI</option>
                        </select>
                    </div>
                </div>
                
                <!-- Campos dinámicos según el vínculo seleccionado -->
                <div id="campos_vinculo_dinamicos" class="row" style="display: none;">
                    <!-- Campos para Hermano/a de alumno/a -->
                    <div id="campos_hermano" class="col-12" style="display: none;">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="dni_hermano" class="form-label">DNI del hermano/a que estudia en la escuela</label>
                                <input type="text" class="form-control" id="dni_hermano" name="dni_hermano" placeholder="DNI del hermano/a">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="nombre_hermano" class="form-label">Nombre del hermano/a</label>
                                <input type="text" class="form-control" id="nombre_hermano" name="nombre_hermano" placeholder="Nombre del hermano/a">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campos para Hijo/a de profesor/a -->
                    <div id="campos_profesor" class="col-12" style="display: none;">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="dni_profesor" class="form-label">DNI del padre/madre profesor/a</label>
                                <input type="text" class="form-control" id="dni_profesor" name="dni_profesor" placeholder="DNI del profesor/a">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="nombre_profesor" class="form-label">Nombre del padre/madre profesor/a</label>
                                <input type="text" class="form-control" id="nombre_profesor" name="nombre_profesor" placeholder="Nombre del profesor/a">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="escuela_profesor" class="form-label">Escuela donde trabaja el profesor/a</label>
                                <input type="text" class="form-control" id="escuela_profesor" name="escuela_profesor" placeholder="Nombre de la escuela">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Campos para PPI -->
                    <div id="campos_ppi" class="col-12" style="display: none;">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="numero_ppi" class="form-label">Número de PPI</label>
                                <input type="text" class="form-control" id="numero_ppi" name="numero_ppi" placeholder="Número de PPI">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="documentacion_ppi" class="form-label">Documentación respaldatoria</label>
                                <input type="file" class="form-control" id="documentacion_ppi" name="documentacion_ppi" accept=".pdf,.jpg,.png">
                                <small class="text-muted">Adjunte documentación que respalde el PPI</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Enviar</button>
        </form>
        
        <div id="resultado" class="mt-4"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Función para manejar el cambio de vínculo y mostrar campos dinámicos
        function handleVinculoChange() {
            const vinculoSelect = document.getElementById('vinculo');
            const camposDinamicos = document.getElementById('campos_vinculo_dinamicos');
            const camposHermano = document.getElementById('campos_hermano');
            const camposProfesor = document.getElementById('campos_profesor');
            const camposPPI = document.getElementById('campos_ppi');
            
            // Ocultar todos los campos dinámicos primero
            camposDinamicos.style.display = 'none';
            camposHermano.style.display = 'none';
            camposProfesor.style.display = 'none';
            camposPPI.style.display = 'none';
            
            // Hacer opcionales todos los campos dinámicos
            const camposDinamicosInputs = camposDinamicos.querySelectorAll('input');
            camposDinamicosInputs.forEach(input => {
                input.removeAttribute('required');
            });
            
            // Mostrar campos según el vínculo seleccionado
            const vinculoId = parseInt(vinculoSelect.value);
            
            switch (vinculoId) {
                case 2: // Hermano/a de alumno/a
                    camposDinamicos.style.display = 'block';
                    camposHermano.style.display = 'block';
                    document.getElementById('dni_hermano').setAttribute('required', 'required');
                    document.getElementById('nombre_hermano').setAttribute('required', 'required');
                    break;
                    
                case 3: // Hijo/a de profesor/a
                    camposDinamicos.style.display = 'block';
                    camposProfesor.style.display = 'block';
                    document.getElementById('dni_profesor').setAttribute('required', 'required');
                    document.getElementById('nombre_profesor').setAttribute('required', 'required');
                    document.getElementById('escuela_profesor').setAttribute('required', 'required');
                    break;
                    
                case 4: // PPI
                    camposDinamicos.style.display = 'block';
                    camposPPI.style.display = 'block';
                    document.getElementById('numero_ppi').setAttribute('required', 'required');
                    document.getElementById('documentacion_ppi').setAttribute('required', 'required');
                    break;
                    
                case 1: // Ninguno
                default:
                    // No mostrar campos adicionales
                    break;
            }
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const vinculoSelect = document.getElementById('vinculo');
            if (vinculoSelect) {
                vinculoSelect.addEventListener('change', handleVinculoChange);
            }
            
            // Manejar el envío del formulario
            document.getElementById('testForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = new FormData(this);
                const resultado = document.getElementById('resultado');
                
                // Mostrar los datos que se enviarían
                let html = '<div class="alert alert-success"><h6>Datos del formulario:</h6><ul>';
                for (let [key, value] of formData.entries()) {
                    if (value instanceof File) {
                        html += `<li><strong>${key}:</strong> ${value.name} (${value.type})</li>`;
                    } else {
                        html += `<li><strong>${key}:</strong> ${value}</li>`;
                    }
                }
                html += '</ul></div>';
                
                resultado.innerHTML = html;
            });
        });
    </script>
</body>
</html>